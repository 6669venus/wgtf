# Use FIND_PACKAGE( Perforce ) to run this script.
SET( BW_NO_UNICODE ON )
INCLUDE( WGToolsProject )
SET( BW_NO_UNICODE OFF )

IF( NOT Perforce_FIND_VERSION )
    SET( Perforce_FIND_VERSION "15.2" )
ENDIF()

IF( BW_PLATFORM_WINDOWS )
	SET( PLATFORM_SUFFIX w )
ELSE()
	MESSAGE( "Skipping 'plg_perforce', currently only windows libraries are available" )
	RETURN()
ENDIF()

SET( PERFORCE_DIR ${WG_TOOLS_THIRD_PARTY_DIR}/perforce/r${Perforce_FIND_VERSION} )

IF( CMAKE_SIZEOF_VOID_P EQUAL 8 )
	SET( PERFORCE_DIR ${PERFORCE_DIR}/bin.ntx64 )
	SET( BITNESS_SUFFIX 64)
ELSE()
	SET( PERFORCE_DIR ${PERFORCE_DIR}/bin.ntx86 )
ENDIF()

SET( OPENSSL_DIR ${WG_TOOLS_THIRD_PARTY_DIR}/OpenSSL )

IF( ${CMAKE_GENERATOR} MATCHES "Visual Studio 11( 2012)? Win64" )
	SET( PERFORCE_DIR ${PERFORCE_DIR}/vs2012 )
ELSEIF( ${CMAKE_GENERATOR} MATCHES "Visual Studio 11( 2012)?" )
	SET( PERFORCE_DIR ${PERFORCE_DIR}/vs2012 )
ELSEIF( ${CMAKE_GENERATOR} MATCHES "Visual Studio 12( 2013)? Win64" )
	SET( PERFORCE_DIR ${PERFORCE_DIR}/vs2013 )
	SET( OPENSSL_DIR ${OPENSSL_DIR}/vs2013 )
ELSEIF( ${CMAKE_GENERATOR} MATCHES "Visual Studio 12( 2013)?" )
	SET( PERFORCE_DIR ${PERFORCE_DIR}/vs2013 )
	SET( OPENSSL_DIR ${OPENSSL_DIR}/vs2013 )
ELSEIF( ${CMAKE_GENERATOR} MATCHES "Visual Studio 14( 2015)? Win64" )
	SET( PERFORCE_DIR ${PERFORCE_DIR}/vs2015 )
	SET( OPENSSL_DIR ${OPENSSL_DIR}/vs2015 )
ELSEIF( ${CMAKE_GENERATOR} MATCHES "Visual Studio 14( 2015)?" )
	SET( PERFORCE_DIR ${PERFORCE_DIR}/vs2015 )
	SET( OPENSSL_DIR ${OPENSSL_DIR}/vs2015 )
ENDIF()

SET( PERFORCE_DIR ${PERFORCE_DIR}_dyn )



IF( EXISTS "${PERFORCE_DIR}" )
	MESSAGE( STATUS "Enabled ${PROJECT_NAME}. PERFORCE found in ${PERFORCE_DIR}." )
	SET( PERFORCE_FOUND TRUE )
	SET( PERFORCE_INCLUDE_DIRS ${PERFORCE_DIR}/Include )
ELSE()
	MESSAGE( STATUS "Disabled ${PROJECT_NAME}. Perforce not found in ${PERFORCE_DIR}." )
	SET( PERFORCE_FOUND FALSE )
ENDIF()

